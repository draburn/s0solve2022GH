myclear;
test_groot;
figIndex = 0;

if (0)
numIter = grootDatOut.numIter;
matJEM0 = grootDatOut.iterDat(numIter-0).matJ;
matJEM1 = grootDatOut.iterDat(numIter-1).matJ;
matJEM2 = grootDatOut.iterDat(numIter-2).matJ;
[uEM0,sEM0,vEM0] = svd(matJEM0);
[uEM1,sEM1,vEM1] = svd(matJEM1);
[uEM2,sEM2,vEM2] = svd(matJEM2);
matV = [ vEM0(:,end), vEM1(:,end), vEM2(:,end) ];
echo__matVTV = (matV')*matV
return
end

matJ = grootDatOut.iterDat(end).matJ;
vecX = grootDatOut.iterDat(end).vecX;
vecXRoot = grootDatOut.vecX0;
%
[u,s,v] = svd(matJ);
%semilogy(diag(s),'o-');
%grid on;
%
uNull = u(:,end);
vNull = v(:,end);
% (end,end) is only diagonal with slope of zero at zero.
sNull = s(end,end)
%
numVals = 1001;
%lambda = linspace(-1E-1,1E-1,numVals);
%lambda = linspace(4.9256,4.9257,numVals);
lambda = linspace(-1E2,1E2,numVals);
matX = vNull*lambda + repmat(vecX,[1,numVals]);
matD = matX - repmat(vecXRoot,[1,numVals]);
matF = funchF(matX);
%
figIndex++; figure(figIndex);
plot(lambda,sqrt(sum(matD.^2,1)),'o-');
grid on;
%
figIndex++; figure(figIndex);
%plot(lambda,sqrt(sum(matF.^2,1)),'o-');
%semilogy(lambda,sqrt(sum(matF.^2,1)),'o-');
%semilogy(lambda,sqrt(sum( ((uNull')*matF).^2, 1 )),'o-'); %Ah!
semilogy(lambda,abs((uNull')*matF),'o-'); %Ah!
%%%plot(lambda,sqrt(sum( ((uNull')*matF).^2, 1 )),'o-'); %Ah!
%%%plot(cent(lambda),diff((uNull')*matF),'o-');
%semilogy(lambda,abs((u(:,1:3:end)')*matF),'o-');
%plot(lambda,((u(:,1:3:end)')*matF),'o-');
grid on;
%
% =(
%
%
if (0)
echo__vecX = vecX
echo__vNull = vNull
else
temp__vecX = [
   0.6715252
   0.4209996
  -0.2036535
  -0.4401050
   0.0575405
  -0.2179274
   0.6047632
  -0.2728844
  -0.0668183
   0.1537326
   0.8598163
  -0.0458249
  -0.4381900
   0.5371529
   0.3078950
  -0.5174083
   1.0004347
   0.0498683
   0.6390038
   0.7804081
  -0.2881242
   0.4560929
   0.7760505
   0.4394116
   0.0577727
   0.0309600
  -0.1205851
   0.1024205
   0.7375525
   0.9187752
  -0.0463440
   0.7274179
  -0.5680966
   0.5994767
   0.1089496
  -0.9746455
   0.4097081
  -0.2819052
   0.6656747
   0.4303604
  -0.9629481
  -0.1004713
   0.7495070
  -0.5356946
  -0.3753442
   0.7608060
  -0.6023000
  -0.1698169
  -0.5478074
   0.9489409
   0.6040350
  -0.1205247
  -0.8570765
  -0.3852349
  -0.0059518
   0.8452302
   0.5920677
   0.7885592
   0.4256964
   0.1449742
   0.0302597
   0.0394223
   0.9031816
  -0.2473649
   0.4634755
  -0.1534462
   0.1781454
   0.3546930
   0.1125779
  -0.3850502
  -0.6105621
  -0.7052260
   0.3293370
   1.0149537
  -0.1116854
  -0.8501455
   0.5286035
   0.7762589
   0.8364289
   0.6274224
   0.8856703
   0.7814273
   0.0183723
  -0.2149027
   0.4016923
  -0.2092378
   0.6104356
   0.6539383
   1.0420651
   0.2109219
   0.8819205
   0.1297944
  -0.1164360
   0.3773939
   1.0534364
   0.8553801
   0.5495324
  -0.7824191
   0.2930462
  -0.0368934
   0.3101908
   0.7185331
  -0.4775753
   0.5160017
  -0.7552651
  -0.5832975
   0.5053212
  -0.4447085
   0.6555806
  -0.7880719
  -0.7232372
   0.3426884
   0.1571904
   0.1451224
   0.8269020
   0.0807808
   0.3511837
  -0.9459837
   0.2396813
   0.1617170
   0.1590104
  -0.3763215
  -0.2771747
   0.3154723
  -0.9296457
  -0.9494151
   1.2797700
  -0.4872945
  -0.7579840
  -0.5814912
   0.6225196
   0.9116195
  -0.9142481
  -0.1238375
  -0.8021296
  -0.4511657
  -0.5643540
   0.3443748
  -0.4198246
  -0.6486384
   0.0521388
   0.1773424
  -0.8482377
   1.0614428
  -0.5584094
  -0.2842705
   0.4781542
   0.6731803
   0.8152276
  -0.6797713
   0.3662735
   0.9370656
  -0.8566111
   0.3327528
   0.6963163
  -0.0996044
  -0.4902439
   0.2223663
  -0.1168257
  -0.7293449
  -0.0621523
  -0.1709059
   0.1329998
   0.0967006
  -0.3872871
  -0.2833439
   0.6540796
  -0.4891939
   0.1309551
  -1.0075616
   0.4004239
  -0.3230034
  -0.8936354
  -0.4541652
  -0.4672701
   0.8966895
  -0.2539048
  -0.4049924
  -0.2915390
   0.8724998
   0.2646346
   0.4312907
   0.3663332
  -0.0845187
  -0.1854221
   0.2563166
  -0.9641845
  -0.5988904
  -0.3826549
  -0.5325249
   0.2756299
  -0.2673858
  -0.4527991
   0.1008245
  -0.2131739
  -0.2292573
   0.2864613
  -0.2180074
   0.2884289
  -0.9073120
  -0.1409383
  -0.4751847
  -0.7051670
   0.0680308
  -0.0410177
   0.1037929
   0.5787795
   0.9388315
   0.2068375
  -0.3765258
  -0.0989086
   0.4479321
   0.7561352
   0.6355979
  -0.4802592
   1.0080708
   0.2458458
  -0.3981446
   0.4797437
   0.8701540
  -0.3732577
   0.3745082
  -0.3632483
  -0.5807608
   0.3999182
  -0.9898634
   0.6285687
   0.0443826
  -0.8587747
  -0.5478691
   0.2911823
   0.7301683
  -0.4538666
   0.9187540
  -0.8254905
   0.7400130
  -0.1301587
  -0.8384122
  -0.3741351
  -0.0897001
   0.5567285
   0.7233267
  -0.6972489
   0.0784075
   0.2396610
  -0.2922749
   0.7718719
  -0.4054963
   0.5197132
  -0.8850055
];
temp__vNull = [
   3.6977e-03
   1.8032e-02
  -2.8970e-02
   7.8306e-03
  -2.0477e-03
   3.0369e-03
  -9.9133e-02
  -9.8592e-02
   1.0281e-02
  -7.6625e-03
  -1.8278e-02
   5.9226e-03
   1.8001e-02
  -3.2379e-02
   3.9936e-03
   9.6758e-03
   3.7011e-02
   3.0045e-02
   1.7528e-02
   3.0291e-04
  -2.0155e-02
  -8.6767e-03
   1.8641e-02
  -7.4569e-03
  -1.3353e-01
  -3.4472e-02
   7.6009e-03
   7.0359e-02
  -3.6847e-01
  -1.1989e-03
   5.9828e-03
  -3.7612e-03
   5.9718e-03
   9.7167e-03
   1.6125e-02
   2.4228e-03
   3.3334e-02
  -3.4093e-02
   7.3386e-03
   5.1642e-03
  -1.2410e-03
  -3.3507e-03
   6.9732e-03
   2.2133e-02
  -6.2665e-03
   9.2893e-03
   3.0971e-03
  -2.7203e-02
  -3.2199e-03
   1.2812e-02
   4.0532e-03
   1.5707e-03
   1.4550e-02
   1.9760e-02
   3.5703e-04
  -3.1512e-03
  -2.1055e-03
  -1.7868e-01
   4.1639e-03
  -8.6319e-03
   1.9368e-03
   1.3804e-03
   8.9997e-04
   7.2569e-02
  -9.1295e-02
   1.2454e-03
   6.6906e-03
  -1.1959e-01
   8.0375e-04
  -9.7722e-03
  -2.9394e-03
   4.1965e-02
  -1.2195e-01
   5.1224e-03
   9.7744e-03
   1.1294e-02
   3.4356e-02
   8.0993e-04
  -1.0502e-02
   4.4175e-05
  -1.4173e-02
  -1.3534e-02
  -1.5582e-02
   1.7865e-02
   7.0849e-03
   2.8317e-02
   7.2936e-03
   3.7188e-03
  -7.3017e-01
  -6.7685e-04
   1.9623e-03
   4.9019e-04
  -6.0854e-04
   4.8045e-04
   1.0779e-03
   2.9491e-03
   6.0847e-03
  -1.6966e-03
  -8.8639e-02
   8.5292e-03
   8.9965e-04
  -2.1256e-02
  -6.8009e-03
  -1.9750e-02
   8.0155e-03
   1.5013e-03
   9.0954e-04
   2.6149e-02
  -9.1530e-03
  -7.3697e-03
   9.1335e-03
   1.5174e-02
   1.6512e-02
  -6.3947e-03
   2.6030e-03
   3.0265e-02
  -4.0116e-02
  -7.2383e-03
   6.3255e-03
   1.0425e-03
   2.7130e-03
   8.7778e-04
   4.7130e-03
   1.5863e-02
  -9.5446e-03
   1.1567e-03
  -3.3871e-02
  -1.8936e-01
  -8.9471e-03
   1.8701e-03
   3.9943e-03
   4.0737e-03
  -1.2422e-02
   1.0126e-02
   1.4514e-03
   2.6451e-03
   7.2364e-03
  -3.4630e-02
  -6.1277e-03
  -9.0805e-03
   5.7993e-02
  -1.3168e-02
  -1.4801e-02
  -2.3552e-02
  -3.3999e-02
   3.2444e-03
   4.7053e-03
  -1.7360e-03
  -3.1266e-03
  -3.9172e-03
  -8.8277e-03
  -6.1925e-03
  -2.9920e-03
   2.6470e-03
   1.2598e-03
  -3.2159e-02
   2.2110e-03
  -1.2980e-02
   3.8054e-03
   4.2396e-03
  -1.6399e-02
   2.5586e-03
   3.3560e-03
  -6.8427e-03
  -2.9627e-03
  -1.6420e-02
   1.5430e-03
   9.1310e-03
  -3.3027e-03
   2.1077e-04
  -1.0286e-02
  -4.8871e-03
  -1.1345e-02
  -1.5438e-02
  -1.3753e-03
   6.1929e-03
   5.0063e-03
  -1.5281e-02
  -1.2163e-02
  -1.7161e-02
   1.3700e-02
  -1.8171e-02
  -1.4408e-02
  -1.4955e-02
   1.0317e-02
  -7.6477e-03
   2.3742e-03
  -6.7940e-03
   5.6515e-03
  -7.5670e-03
  -5.8224e-03
  -2.8091e-03
  -1.9153e-02
   3.8752e-03
   5.3440e-03
   2.2920e-02
   5.6178e-02
   8.7173e-04
   2.6778e-03
   3.3895e-03
  -6.5890e-03
   2.3142e-03
   2.1003e-04
   1.7401e-03
   3.0311e-04
  -4.5335e-03
  -2.4500e-03
   5.7413e-02
  -1.3800e-01
   1.3911e-02
  -3.4048e-03
   3.9567e-02
  -7.3049e-03
  -2.6112e-03
   2.0842e-02
  -3.2993e-03
   9.6106e-03
   2.0722e-01
  -1.1023e-02
   2.3767e-01
   1.9628e-02
  -1.0984e-03
   5.5657e-03
  -1.6734e-02
  -1.6080e-02
  -1.9867e-03
  -2.2290e-03
   1.1108e-02
  -3.8382e-03
  -7.2656e-04
  -1.2180e-02
   2.6117e-03
   1.8814e-02
  -3.7331e-03
   9.0312e-03
   1.6875e-03
   1.3704e-02
  -1.1912e-04
   9.8161e-03
   6.7842e-03
   1.8848e-03
  -5.4793e-04
   2.0507e-03
  -8.0036e-03
  -5.1227e-02
  -6.2285e-04
   8.7331e-05
  -9.7530e-03
   7.5774e-04
  -6.8839e-03
];
end
